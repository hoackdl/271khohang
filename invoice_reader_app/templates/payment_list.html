{% extends "base.html" %}
{% load humanize %}
{% block navbar_title %}Danh sách phiếu thu{% endblock %}


{% block content %}
            <form method="get" class="d-inline">
                <select name="year" class="form-select form-select-sm"
                        onchange="this.form.submit()">
                    {% for y in year_list %}
                    <option value="{{ y }}" {% if y == current_year %}selected{% endif %}>
                        Năm {{ y }}
                    </option>
                    {% endfor %}
                </select>
            </form>
<form method="post">
    {% csrf_token %}
    <table class="table table-bordered table-striped text-center">
        <thead>
            <tr>
                <th>Chọn</th>
                <th>TT</th>
                <th>Số phiếu</th>
                <th>Ngày thu</th>
                <th>Nội dung</th>
                <th>Tổng thu</th>
                <th>Thực thu</th>
                <th>Còn phải thu</th>
            </tr>
        </thead>
        <tbody>
            {% for payment in payments %}
            <tr>
                <td><input type="checkbox" name="delete_ids" value="{{ payment.id }}"></td>
                <td>{{ forloop.counter }}</td>
                <td>{{ payment.doc_no }}</td>
                <td>{{ payment.payment_date|date:"d/m/Y" }}</td>
                <td class="text-start">{{ payment.content }}</td>
                <td class="text-end">{{ payment.amount|floatformat:0|intcomma }}</td>
                <td class="text-end text-success">{{ payment.credit|floatformat:0|intcomma }}</td>
                <td class="text-end {% if payment.remaining < 0 %}text-danger{% endif %}">
                    {{ payment.remaining|floatformat:0|intcomma }}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8">Chưa có phiếu thu mới nào</td>
            </tr>
            {% endfor %}

            <tr class="fw-bold table-secondary">
                <td colspan="5">Tổng</td>
                <td class="text-end">{{ total_amount|floatformat:0|intcomma }}</td>
                <td class="text-end text-success">{{ total_credit|floatformat:0|intcomma }}</td>
                <td></td>
            </tr>
        </tbody>
    </table>

    <button type="submit" class="btn btn-danger mt-2">Xóa phiếu đã chọn</button>
</form>

<a href="{% url 'bank_payments_manage' %}" class="btn btn-secondary mt-2">Quay lại quản lý ngân hàng</a>


<script>
function toggleAll(source) {
    checkboxes = document.getElementsByName('delete_ids');
    for(var i=0, n=checkboxes.length;i<n;i++) {
        checkboxes[i].checked = source.checked;
    }
}
</script>


{% endblock content %}